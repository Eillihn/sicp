#lang sicp
(#%require "../../../helpers/stream.scm")

; Examine the stream (pairs integers integers). Can you make any general
; comments about the order in which the pairs are placed into the stream? For example, about how many
; pairs precede the pair (1,100)? the pair (99,100)? the pair (100,100)? (If you can make precise mathematical
; statements here, all the better. But feel free to give more qualitative answers if you find yourself getting
; bogged down.)



; Answer:

(define (pairs s t)
    (cons-stream
        (list (stream-car s) (stream-car t))
        (interleave
            (stream-map (lambda (x) (list (stream-car s) x))
                        (stream-cdr t))
            (pairs (stream-cdr s) (stream-cdr t)))))

(do ((i 0 (+ i 1)))
    ((= i 10))
    (newline)
    (display (stream-ref (pairs integers integers) i)))

; Ouput:
; (1 1)
; (1 2)
; (2 2)
; (1 3)
; (2 3)
; (1 4)
; (3 3)
; (1 5)
; (2 4)
; (1 6)

; From the output we can see that, since (1, 2), (1, n) appears in even times, so 
; (1,100) -> n * 2 - 2 = 100 * 2 - 2 = 198              ~ n * 2 ^ m
; (2,100) -> n * 2 * 2 - 7 = 100 * 4 - 7 = 393          ~ n * 2 ^ m
; (3,100) -> n * 2 * 2 * 2 - 21 = 100 * 8 - 21 = 779    ~ n * 2 ^ m
; =>
; (99,100)      ~ n * 2 ^ m => 100 * 2 ^ 99
; (100,100)     ~ n * 2 ^ m => 100 * 2 ^ 100
